// Add this to the top of your script.js
document.addEventListener('DOMContentLoaded', function() {
    // Initialize particles
    particlesJS('particles-js', {
        particles: {
            number: {
                value: 50,
                density: {
                    enable: true,
                    value_area: 800
                }
            },
            color: {
                value: '#ffcc00'
            },
            shape: {
                type: 'circle'
            },
            opacity: {
                value: 0.5,
                random: false
            },
            size: {
                value: 3,
                random: true
            },
            line_linked: {
                enable: true,
                distance: 150,
                color: '#ffcc00',
                opacity: 0.4,
                width: 1
            },
            move: {
                enable: true,
                speed: 2,
                direction: 'none',
                random: false,
                straight: false,
                out_mode: 'out',
                bounce: false
            }
        },
        interactivity: {
            detect_on: 'canvas',
            events: {
                onhover: {
                    enable: true,
                    mode: 'grab'
                },
                onclick: {
                    enable: true,
                    mode: 'push'
                },
                resize: true
            }
        },
        retina_detect: true
    });

    // Animate skill bars
    const skillBars = document.querySelectorAll('.skill-progress');
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.width = entry.target.getAttribute('data-progress') + '%';
            }
        });
    });

    skillBars.forEach(bar => observer.observe(bar));
});

// Create trailing cursors
const numTrails = 10;
const trails = [];

for (let i = 0; i < numTrails; i++) {
    const trail = document.createElement('div');
    trail.className = 'cursor-trail';
    document.body.appendChild(trail);
    trails.push({
        element: trail,
        x: 0,
        y: 0
    });
}

const mainCursor = document.getElementById('trailing-cursor');
let mouseX = 0;
let mouseY = 0;

// Track mouse movement
document.addEventListener('mousemove', (e) => {
    mouseX = e.clientX;
    mouseY = e.clientY;
    
    // Update main cursor
    mainCursor.style.transform = `translate(${mouseX}px, ${mouseY}px)`;
});

// Animation loop for smooth trailing effect
function animate() {
    let x = mouseX;
    let y = mouseY;
    
    trails.forEach((trail, index) => {
        trail.x += (x - trail.x) * 0.3;
        trail.y += (y - trail.y) * 0.3;
        
        trail.element.style.transform = `translate(${trail.x}px, ${trail.y}px)`;
        
        x = trail.x;
        y = trail.y;
    });
    
    requestAnimationFrame(animate);
}

animate();

// Function to validate email format
function validateEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}

// Form Submission Scripts
document.getElementById('contact-form').addEventListener('submit', function(event) {
    event.preventDefault();
    let name = document.getElementById('name').value;
    let email = document.getElementById('email').value;
    let message = document.getElementById('message').value;

    if (!validateEmail(email)) {
        alert('shivampainuly01@gmail.com.');
        return;
    }

    let mailtoLink = `mailto:shivampainuly01@gmail.com?subject=Contact from ${encodeURIComponent(name)}&body=${encodeURIComponent(message)}`;
    window.location.href = mailtoLink;
});

document.getElementById('chatbox-form').addEventListener('submit', function(event) {
    event.preventDefault();
    let name = document.getElementById('chat-name').value;
    let email = document.getElementById('chat-email').value;
    let message = document.getElementById('chat-message').value;

    if (!validateEmail(email)) {
        alert('shivampainuly01@gmail.com');
        return;
    }

    let chatMailtoLink = `mailto:shivampainuly01@gmail.com?subject=Chat from ${encodeURIComponent(name)}&body=Email: ${encodeURIComponent(email)}%0D%0A${encodeURIComponent(message)}`;
    window.location.href = chatMailtoLink;
});
